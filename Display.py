# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'Display.ui'
#
# Created by: PyQt5 UI code generator 5.15.7
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.

import cv2
from PyQt5 import QtCore, QtGui, QtWidgets
from Test_model import authentication
import time

class Ui_Dialog(object):
    def setupUi(self, Dialog):
        Dialog.setObjectName("Dialog")
        Dialog.resize(513, 863)
        font = QtGui.QFont()
        font.setFamily("JetBrains Mono")
        font.setPointSize(14)
        font.setBold(True)
        font.setWeight(75)
        Dialog.setFont(font)
        Dialog.setAutoFillBackground(False)
        Dialog.setStyleSheet("background-color: rgb(225, 255, 255);")
        Dialog.setModal(False)
        self.verticalLayoutWidget = QtWidgets.QWidget(Dialog)
        self.verticalLayoutWidget.setGeometry(QtCore.QRect(10, 10, 491, 841))
        self.verticalLayoutWidget.setObjectName("verticalLayoutWidget")
        self.verticalLayout_1 = QtWidgets.QVBoxLayout(self.verticalLayoutWidget)
        self.verticalLayout_1.setContentsMargins(0, 0, 0, 0)
        self.verticalLayout_1.setObjectName("verticalLayout_1")
        self.verticalLayout_2 = QtWidgets.QVBoxLayout()
        self.verticalLayout_2.setObjectName("verticalLayout_2")
        self.tenchuongtrinh = QtWidgets.QLabel(self.verticalLayoutWidget)
        font = QtGui.QFont()
        font.setPointSize(14)
        self.tenchuongtrinh.setFont(font)
        self.tenchuongtrinh.setObjectName("tenchuongtrinh")
        self.verticalLayout_2.addWidget(self.tenchuongtrinh, 0, QtCore.Qt.AlignHCenter)
        self.verticalLayout_1.addLayout(self.verticalLayout_2)
        self.verticalLayout_3 = QtWidgets.QVBoxLayout()
        self.verticalLayout_3.setObjectName("verticalLayout_3")
        self.label = QtWidgets.QLabel(self.verticalLayoutWidget)
        self.label.setStyleSheet("border-color: rgb(17, 17, 17);")
        self.label.setObjectName("label")
        self.verticalLayout_3.addWidget(self.label)
        self.horizontalLayout_8 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_8.setObjectName("horizontalLayout_8")
        self.horizontalLayout_9 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_9.setObjectName("horizontalLayout_9")
        self.label_4 = QtWidgets.QLabel(self.verticalLayoutWidget)
        self.label_4.setObjectName("label_4")
        self.horizontalLayout_9.addWidget(self.label_4)
        self.horizontalLayout_8.addLayout(self.horizontalLayout_9)
        self.lbketqua = QtWidgets.QLabel(self.verticalLayoutWidget)
        self.lbketqua.setObjectName("lbketqua")
        self.horizontalLayout_8.addWidget(self.lbketqua)
        self.horizontalLayout_8.setStretch(0, 3)
        self.horizontalLayout_8.setStretch(1, 5)
        self.verticalLayout_3.addLayout(self.horizontalLayout_8)
        spacerItem = QtWidgets.QSpacerItem(20, 40, QtWidgets.QSizePolicy.Minimum, QtWidgets.QSizePolicy.Expanding)
        self.verticalLayout_3.addItem(spacerItem)
        self.verticalLayout_3.setStretch(0, 6)
        self.verticalLayout_3.setStretch(1, 1)
        self.verticalLayout_1.addLayout(self.verticalLayout_3)
        self.horizontalLayout_4 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_4.setContentsMargins(-1, 0, -1, -1)
        self.horizontalLayout_4.setObjectName("horizontalLayout_4")
        self.formLayout = QtWidgets.QFormLayout()
        self.formLayout.setObjectName("formLayout")
        self.label1 = QtWidgets.QLabel(self.verticalLayoutWidget)
        self.label1.setObjectName("label1")
        self.formLayout.setWidget(0, QtWidgets.QFormLayout.LabelRole, self.label1)
        self.lbimage = QtWidgets.QLineEdit(self.verticalLayoutWidget)
        font = QtGui.QFont()
        font.setPointSize(10)
        self.lbimage.setFont(font)
        self.lbimage.setObjectName("lbimage")
        self.formLayout.setWidget(0, QtWidgets.QFormLayout.FieldRole, self.lbimage)
        spacerItem1 = QtWidgets.QSpacerItem(20, 40, QtWidgets.QSizePolicy.Minimum, QtWidgets.QSizePolicy.Expanding)
        self.formLayout.setItem(1, QtWidgets.QFormLayout.FieldRole, spacerItem1)
        self.label2 = QtWidgets.QLabel(self.verticalLayoutWidget)
        self.label2.setObjectName("label2")
        self.formLayout.setWidget(2, QtWidgets.QFormLayout.LabelRole, self.label2)
        self.lbmodel = QtWidgets.QLineEdit(self.verticalLayoutWidget)
        font = QtGui.QFont()
        font.setPointSize(10)
        self.lbmodel.setFont(font)
        self.lbmodel.setObjectName("lbmodel")
        self.formLayout.setWidget(2, QtWidgets.QFormLayout.FieldRole, self.lbmodel)
        self.horizontalLayout_4.addLayout(self.formLayout)
        self.verticalLayout_5 = QtWidgets.QVBoxLayout()
        self.verticalLayout_5.setObjectName("verticalLayout_5")
        self.bt1 = QtWidgets.QPushButton(self.verticalLayoutWidget)
        font = QtGui.QFont()
        font.setFamily("MS Shell Dlg 2")
        font.setPointSize(9)
        self.bt1.setFont(font)
        self.bt1.setStyleSheet("border-color: rgb(22, 22, 22);\n"
"background-color: rgb(207, 207, 207);")
        icon = QtGui.QIcon()
        icon.addPixmap(QtGui.QPixmap("../../../../Program Files (x86)/Qt Designer/Icon/Lovepik_com-400219390-folder.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        icon1 = QtGui.QIcon()
        icon1.addPixmap(QtGui.QPixmap("../../../../Program Files (x86)/Qt Designer/Icon/Web  (26).png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.bt1.setIcon(icon)
        self.bt1.setObjectName("bt1")
        self.bt1.clicked.connect(self.chooseImage)
        self.verticalLayout_5.addWidget(self.bt1)
        spacerItem2 = QtWidgets.QSpacerItem(20, 40, QtWidgets.QSizePolicy.Minimum, QtWidgets.QSizePolicy.Expanding)
        self.verticalLayout_5.addItem(spacerItem2)
        self.bt2 = QtWidgets.QPushButton(self.verticalLayoutWidget)
        font = QtGui.QFont()
        font.setFamily("MS Shell Dlg 2")
        font.setPointSize(9)
        self.bt2.setFont(font)
        self.bt2.setStyleSheet("border-color: rgb(22, 22, 22);\n"
"background-color: rgb(207, 207, 207);")
        self.bt2.setIcon(icon1)
        self.bt2.setObjectName("bt2")
        self.bt2.clicked.connect(self.chooseModel)
        self.verticalLayout_5.addWidget(self.bt2)
        self.horizontalLayout_4.addLayout(self.verticalLayout_5)
        self.verticalLayout_1.addLayout(self.horizontalLayout_4)
        self.horizontalLayout = QtWidgets.QHBoxLayout()
        self.horizontalLayout.setObjectName("horizontalLayout")
        self.verticalLayout_6 = QtWidgets.QVBoxLayout()
        self.verticalLayout_6.setObjectName("verticalLayout_6")
        self.label_2 = QtWidgets.QLabel(self.verticalLayoutWidget)
        font = QtGui.QFont()
        font.setPointSize(10)
        self.label_2.setFont(font)
        self.label_2.setObjectName("label_2")
        self.verticalLayout_6.addWidget(self.label_2)
        self.bt3 = QtWidgets.QPushButton(self.verticalLayoutWidget)
        font = QtGui.QFont()
        font.setFamily("MS Shell Dlg 2")
        font.setPointSize(9)
        self.bt3.setFont(font)
        self.bt3.setStyleSheet("border-color: rgb(0, 0, 0);\n"
"background-color: rgb(207, 207, 207);")
        icon2 = QtGui.QIcon()
        icon2.addPixmap(QtGui.QPixmap("../../../../Program Files (x86)/Qt Designer/Icon/—Pngtree—blue triangle button illustration_4508437.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.bt3.setIcon(icon2)
        self.bt3.setObjectName("bt3")
        self.bt3.clicked.connect(self.processing)
        self.verticalLayout_6.addWidget(self.bt3)
        self.horizontalLayout.addLayout(self.verticalLayout_6)
        self.verticalLayout_7 = QtWidgets.QVBoxLayout()
        self.verticalLayout_7.setObjectName("verticalLayout_7")
        self.label_3 = QtWidgets.QLabel(self.verticalLayoutWidget)
        self.label_3.setObjectName("label_3")
        self.verticalLayout_7.addWidget(self.label_3)
        self.bt4 = QtWidgets.QPushButton(self.verticalLayoutWidget)
        font = QtGui.QFont()
        font.setFamily("MS Shell Dlg 2")
        font.setPointSize(9)
        self.bt4.setFont(font)
        self.bt4.setStyleSheet("border-color: rgb(0, 0, 0);\n"
"background-color: rgb(207, 207, 207);")
        icon3 = QtGui.QIcon()
        icon3.addPixmap(QtGui.QPixmap("../../../../Program Files (x86)/Qt Designer/Icon/x-1152114_1280.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.bt4.setIcon(icon3)
        self.bt4.setObjectName("bt4")
        self.bt4.clicked.connect(self.close_exit)
        self.verticalLayout_7.addWidget(self.bt4)
        self.horizontalLayout.addLayout(self.verticalLayout_7)
        self.verticalLayout_1.addLayout(self.horizontalLayout)
        self.verticalLayout_1.setStretch(0, 1)
        self.verticalLayout_1.setStretch(1, 8)
        self.verticalLayout_1.setStretch(2, 1)
        self.verticalLayout_1.setStretch(3, 1)

        self.retranslateUi(Dialog)
        QtCore.QMetaObject.connectSlotsByName(Dialog)

    def retranslateUi(self, Dialog):
        _translate = QtCore.QCoreApplication.translate
        Dialog.setWindowTitle(_translate("Dialog", "Dialog"))
        self.tenchuongtrinh.setText(_translate("Dialog", "<html><head/><body><p align=\"center\"><span style=\" font-size:12pt; font-weight:600; color:#0a2ef7;\">Xác thực khuôn mặt</span></p></body></html>"))
        self.label.setText(_translate("Dialog", "<html><head/><body><p align=\"center\">Image</p></body></html>"))
        self.label_4.setText(_translate("Dialog", "<html><head/><body><p align=\"center\"><span style=\" font-size:12pt; font-weight:600;\">Kết quả:</span></p></body></html>"))
        self.lbketqua.setText(_translate("Dialog", "<html><head/><body><p><br/></p></body></html>"))
        self.label1.setText(_translate("Dialog", "<html><head/><body><p><span style=\" font-size:11pt; font-weight:600;\">Chọn hình</span></p></body></html>"))
        self.label2.setText(_translate("Dialog", "<html><head/><body><p><span style=\" font-size:11pt; font-weight:600;\">Chọn model</span></p></body></html>"))
        self.bt1.setText(_translate("Dialog", "Image"))
        self.bt2.setText(_translate("Dialog", "Model"))
        self.label_2.setText(_translate("Dialog", "<html><head/><body><p align=\"center\"><span style=\" font-size:11pt; font-weight:600;\">Xác thực</span></p></body></html>"))
        self.bt3.setText(_translate("Dialog", "Start"))
        self.label_3.setText(_translate("Dialog", "<html><head/><body><p align=\"center\"><span style=\" font-size:11pt; font-weight:600;\">Thoát</span></p></body></html>"))
        self.bt4.setText(_translate("Dialog", "Exit"))
    def close_exit(self):
        exit(0)

    def chooseImage(self):
        imageInput = QtWidgets.QFileDialog.getOpenFileName(filter='Face(*.png *.jpg *.bmp)')
        imagePath = imageInput[0]
        self.lbimage.setText(imagePath)
        imagedir = cv2.imread(imagePath)
        image = cv2.cvtColor(imagedir, cv2.COLOR_BGR2RGB)
        photo = cv2.resize(image, (487, 465))
        img = QtGui.QImage(photo, photo.shape[1], photo.shape[0], photo.strides[0],
                           QtGui.QImage.Format_RGB888)
        self.label.setPixmap(QtGui.QPixmap.fromImage(img))

    def chooseModel(self):
        modelInput = QtWidgets.QFileDialog.getOpenFileName(filter='Face(*.h5)')
        model_path = modelInput[0]
        self.lbmodel.setText(model_path)
    def processing(self):
        model_path = self.lbmodel.text()
        test_path = self.lbimage.text()
        if test_path == "" or model_path == "":
            QtWidgets.QMessageBox.about(None, "Error", "Empty image or model")
        else:
            StartTime = time.time()
            QtWidgets.QMessageBox.about(None, "Successful", "Successful!")
            ketqua = authentication(model_path,test_path)
            EndTime = time.time()
            thoigian = str(round((EndTime-StartTime),4))
            self.lbketqua.setText(ketqua +'      ~ '+ thoigian+' s')

if __name__ == "__main__":
    import sys
    app = QtWidgets.QApplication(sys.argv)
    Dialog = QtWidgets.QDialog()
    ui = Ui_Dialog()
    ui.setupUi(Dialog)
    Dialog.show()
    sys.exit(app.exec_())
